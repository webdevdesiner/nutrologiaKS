/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
/*
 * @name wowBook
 *
 * @author Marcio Aguiar
 * @version 1.0
 * @requires jQuery v1.7.0
 * 
 * Copyright 2010 Marcio Aguiar. All rights reserved.
 * 
 * To use this file you must to buy a licence at http://codecanyon.net/user/maguiar01/portfolio
 *
 * Date: Wed Dec 8 10:05:49 2010 -0200
 */
(function(d,t,r){function s(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var j="hashchange",l=document,n,a=d.event.special,b=l.documentMode,c="on"+j in t&&(b===r||7<b);d.fn[j]=function(a){return a?this.bind(j,a):this.trigger(j)};d.fn[j].delay=50;a[j]=d.extend(a[j],{setup:function(){if(c)return!1;d(n.start)},teardown:function(){if(c)return!1;d(n.stop)}});n=function(){function a(){var b=s(),c=v(h);b!==h?(p(h=b,c),d(t).trigger(j)):c!==h&&(location.href=location.href.replace(/#.*/,
"")+c);g=setTimeout(a,d.fn[j].delay)}var b={},g,h=s(),i=function(a){return a},p=i,v=i;b.start=function(){g||a()};b.stop=function(){g&&clearTimeout(g);g=r};d.browser.msie&&!c&&function(){var c,g;b.start=function(){c||(g=(g=d.fn[j].src)&&g+s(),c=d('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){g||p(s());a()}).attr("src",g||"javascript:0").insertAfter("body")[0].contentWindow,l.onpropertychange=function(){try{"title"===event.propertyName&&(c.document.title=l.title)}catch(a){}})};
b.stop=i;v=function(){return s(c.location.href)};p=function(a,b){var f=c.document,e=d.fn[j].domain;a!==b&&(f.title=l.title,f.open(),e&&f.write('<script>document.domain="'+e+'"<\/script>'),f.close(),c.location.hash=a)}}();return b}()})(jQuery,this);
(function(d){function t(a,b){var a=d(a),c=this;this.elem=a;this.id=a.attr("id");this.pages=[];this.opts=b;this.currentPage=null;this.pageWidth=b.width/2;this.pageHeight=b.height;this.transparentPages=b.transparentPages=!1;this.startPage=b.startPage;this.onShowPage=b.onShowPage;this.slideShow=b.slideShow;this.slideShowDelay=b.slideShowDelay;this.pauseOnHover=b.pauseOnHover;this.turnPageDuration=b.turnPageDuration;this.foldGradient=b.foldGradient;this.foldGradientThreshold=b.foldGradientThreshold;this.shadows=
b.shadows;this.shadowThreshold=b.shadowThreshold;this.clipBoundaries=b.clipBoundaries;this.zoomLevel=b.zoomLevel;this.zoomMax=b.zoomMax;this.zoomBoundingBox=b.zoomBoundingBox;this.zoomStep=b.zoomStep;this.onZoom=b.onZoom;this.mouseWheel=b.mouseWheel;this.flipSound=b.flipSound;this.centeredWhenClosed=b.centeredWhenClosed;this.sectionDefinition=b.sections;d.support.filters="filters"in a[0];var f=this.pageWidth,e=this.pageHeight;a.addClass("wowbook");"static"===a.css("position")&&a.css("position","relative");
a.css({height:b.height,width:b.width});var g=a.children(),h=this.pagesContainer=this.origin=d("<div class='wowbook-origin'></div>").css({position:"absolute",width:"100%",height:a.height()}).appendTo(a);c.bookShadow=d("<div class='wowbook-book-shadow'></div>").appendTo(a).css({width:b.width,height:b.height,top:0,position:"absolute",display:"none",zIndex:0});this.insertPages(g,!0);h.append("<div class='wowbook-shadow-clipper'><div class='wowbook-shadow-container'><div class='wowbook-shadow-internal'></div></div></div>");
c.shadowContainer=d(".wowbook-shadow-container",h);c.internalShadow=d(".wowbook-shadow-internal",h);c.shadowClipper=d(".wowbook-shadow-clipper",h).css({display:"none",width:a.width(),height:a.height()});c.foldShadow=d("<div class='wowbook-shadow-fold'></div>").appendTo(c.shadowContainer);c.foldGradientContainer=d("<div class='wowbook-fold-gradient-container'></div>").appendTo(c.shadowContainer);c.foldGradientElem=d("<div class='wowbook-fold-gradient'></div>").appendTo(c.foldGradientContainer);c.hardPageShadow=
d("<div class='wowbook-hard-page-shadow'></div>").css({display:"none",width:f,height:e}).appendTo(h);!d.support.opacity&&d.support.filters&&d.wowBook.applyAlphaImageLoader(["wowbook-fold-gradient","wowbook-fold-gradient-flipped","wowbook-shadow-fold","wowbook-shadow-fold-flipped"]);c.shadowContainer.css("position","relative");this.leftHandle=d("<div class='wowbook-handle wowbook-left'></div>").data("corner","l").appendTo(h);this.rightHandle=d("<div class='wowbook-handle wowbook-right'></div>").data("corner",
"r").appendTo(h);b.handleWidth&&d(".wowbook-handle",h).css("width",b.handleWidth);this.rightHandle.css("left",b.width-this.rightHandle.width());d(".wowbook-handle",h).bind("mousedown",function(a){return c.pageEdgeDragStart(a)});var i;d(".wowbook-handle",h).mousedown(function(){i=d.now()}).mouseup(function(){if(!((new Date).getTime()-i>c.opts.handleClickDuration)){var a=d(this).data("corner");"r"===a&&c.advance();"l"===a&&c.back()}});var p=!1;a.hover(function(){if(c.pauseOnHover){p=c.slideShowTimer;
var a=d(c.opts.controls.slideShow),b=a.hasClass("wowbook-disabled");c.stopSlideShow();a.toggleClass("wowbook-disabled",b)}},function(){c.pauseOnHover&&p&&c.startSlideShow()});this.clipBoundaries&&(g=Math.sqrt(f*f+e*e),g=[e-g,a.width(),g,0],this.origin.wrap("<div class='wowbook-clipper'><div class='wowbook-inner-clipper'></div></div>").css("top",-g[0]),d(".wowbook-inner-clipper",a).css({position:"absolute",width:"100%",height:g[2]-g[0],top:g[0],overflow:"hidden"}),this.clipper=d(".wowbook-clipper",
a).css({position:"absolute",left:0,top:0,width:"100%",height:a.height(),overflow:"hidden",zIndex:1}));a.wrapInner("<div class='wowbook-zoomwindow'><div class='wowbook-zoomcontent'></div></div>");this.zoomWindow=d(".wowbook-zoomwindow",a);this.zoomContent=d(".wowbook-zoomcontent",a);d.browser.ie8&&this.zoomContent.wrapInner("<div class='IE8-zoom-helper'style='position:relative'></div>");this.zoomWindow.css({position:"absolute",width:2*f,height:a.height(),top:0});this.zoomContent.css({position:"absolute",
width:2*f,height:a.height(),left:0,top:0});this.fillToc();b.deepLinking&&this.getLocationHash()&&(g=c.selectorToPage("#"+this.getLocationHash()),void 0===g&&(g=c.locationHashToPage()),"number"===typeof g&&(c.startPage=g,s(c.elem)||c.elem[0].scrollIntoView()));this.showPage(this.startPage,!1);this.corners={tl:[0,0],bl:[0,e],tr:[f,0],br:[f,e],l:[0,0],r:[f,0]};this.audio=this.createAudioPlayer();this.opts.keyboardNavigation&&d(document).keydown(function(a){if(!d(a.target).filter("input, textarea, select").length){a.which===
c.opts.keyboardNavigation.back&&c.back();a.which===c.opts.keyboardNavigation.advance&&c.advance()}});d(window).hashchange(function(){var a=window.location.hash;if(a===c.locationHashSetTo)c.locationHashSetTo=void 0;else{var b=(a=a===""&&!c.locationEndsInHash())?c.startPage:c.locationHashToPage();if(typeof b==="number"){c.gotoPage(b,!a);!a&&!s(c.elem)&&c.elem[0].scrollIntoView()}}});b.forceBasicPage&&(this.foldPage=this.holdHardpage=this.foldPageBasic);d.support.transform||(this.foldPage=this.foldPageBasic,
d.support.filters||(this.holdHardpage=this.foldPageBasic));this.mouseWheel&&a.mousewheel(function(a,b){if(c.mouseWheel){if(c.mouseWheel==="zoom"){b>0&&c.zoomIn();b<0&&c.zoomOut();c.zoomedAt(a)}else{b>0&&c.advance();b<0&&c.back()}return false}});this.controllify(this.opts.controls);b.slideShow&&this.startSlideShow()}function r(a,b){var c=Math.cos(b),f=Math.sin(b);return{x:c*a.x-f*a.y,y:f*a.x+c*a.y}}function s(a){var b=d(window).height(),c=a.offset(),f=d(window).scrollTop();return c.top>f&&c.top+a.height()<
f+b}function j(a,b,c){var f,e,g,h;f=e=0;if(!d.support.boxSizing){var i;f="none"==a.css("borderTopStyle")?0:n[i=a.css("borderTopWidth")]||parseFloat(i);e="none"==a.css("borderRightStyle")?0:n[i=a.css("borderRightWidth")]||parseFloat(i);g="none"==a.css("borderBottomStyle")?0:n[i=a.css("borderBottomWidth")]||parseFloat(i);h="none"==a.css("borderLeftStyle")?0:n[i=a.css("borderLeftWidth")]||parseFloat(i);e=parseFloat(a.css("paddingLeft"))+parseFloat(a.css("paddingRight"))+h+e;f=parseFloat(a.css("paddingTop"))+
parseFloat(a.css("paddingBottom"))+f+g}a.css("width",b-e);a.css("height",c-f)}d.wowBook=function(a){return d(a).data("wowBook")};d.fn.wowBook=function(a){if("string"===typeof a){var b=Array.prototype.slice.call(arguments,1);if("options"===a||"prop"===a){var c=d.wowBook(this[0]),f=b[0];return 1<b.length?c[f]=b[1]:c[f]}return this.each(function(){var c=d.wowBook(this);c[a].apply(c,b)})}var e=d.extend({},d.wowBook.defaults,a);return this.each(function(){var a=new t(this,e);d(this).data("wowBook",a)})};
t.prototype={insertPages:function(a,b){for(var c=0,f=a.length;c<f;c++)this.insertPage(a[c],!0);this.updateBook(b)},insertPage:function(a,b){var a=d(a).addClass("wowbook-page-content"),c=d("<div class='wowbook-page'></div>").css({width:this.pageWidth,height:this.pageHeight,display:"none",position:"absolute"}).appendTo(this.pagesContainer).append(a);d.support.boxSizing&&a.css(d.support.boxSizing,"border-box");j(a,this.pageWidth,this.pageHeight);c.hardPageSetByUser=a.hasClass("wowbook-hardpage");this.opts.gutterShadow&&
d("<div class='wowbook-gutter-shadow'></div>").appendTo(a).css("height",this.pageHeight);this.pages.push(c);b||this.updateBook();return c},removePages:function(a,b){arguments.length||(a=0,b=-1);this.holdedPage&&this.releasePage(this.holdedPage);var c=this.pages,b=(b||a)+1||c.length,f=c.slice(a,b),e=c.slice(b);c.length=0>a?c.length+a:a;c.push.apply(c,e);for(var e=0,d=f.length;e<d;e++)f[e].remove();this.updateBook();return c.length},updateBook:function(a){this.doPageNumbering();this.findPagesType();
this.positionBookShadow();for(var b=!1,c,f=0,e=this.pages.length;f<e;f++)c=this.pages[f].toggleClass("wowbook-left",b).toggleClass("wowbook-right",!b).data({pageIndex:f,holded:!1}),c.pageIndex=f,b=!b;this.findSections();a||this.showPage(this.currentPage)},doPageNumbering:function(){var a=this.opts;if(a.pageNumbers){var b=a.numberedPages,a=this.pages.length-1,c=this.pageIsOnTheLeft(a);"all"==b&&(b=[0,-1]);b||(b=[2,c?-3:-2]);var f=b[0],b=b[1];0>f&&(f=a+f+1);0>f&&(f=0);f>this.pages.length-1&&(f=a);0>
b&&(b=a+b+1);0>b&&(b=0);b>this.pages.length-1&&(b=a);for(var e=this.opts.firstPageNumber,c=0;c<f;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=b+1;c<a;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=f;c<=b;c++)a=d(".wowbook-page-number",this.pages[c]),a.length||(a=d(".wowbook-page-content",this.pages[c]),a=d('<div class="wowbook-page-number"></div>').appendTo(a)),a.html(e++)}},findPagesType:function(){var a=this.opts,b={},c,f,e;e=a.hardPages||[];var d=!0===e;if(!d){a.hardcovers&&
(e.push(0,1,-1),this.pageIsOnTheLeft(this.pages.length-1)&&e.push(-2));a=0;for(f=e.length;a<f;a++)c=e[a],0>c&&(c=this.pages.length+c),0<=c&&c<this.pages.length&&(b[c]=!0)}for(a=this.pages.length;a--;)e=d||b[a]||this.pages[a].hardPageSetByUser,this.pages[a].toggleClass("wowbook-hardpage",e).isHardPage=e},showPage:function(a,b){0>a&&(a=0);a>this.pages.length-1&&(a=this.pages.length-1);this.currentPage=a;for(var c=a-(1-a%2),f=c+1,e=this.pageWidth,g=!1,h,i,p=0,j=this.pages.length;p<j;p++)h=g?p:j-p,i=
this.transparentPages?g?p<=c?"block":"none":p>=f?"block":"none":p===c-2||p===c||p===f||p===f+2?"block":"none",this.pages[p].data("zIndex",h).css({display:i,left:g?0:e,top:0,zIndex:h}),g=!g;c=0<a;f=this.rightPage();this.leftHandle.toggleClass("wowbook-disabled",!c);this.rightHandle.toggleClass("wowbook-disabled",!(f&&this.backPage(f.pageIndex)));d(this.opts.controls.back).toggleClass("wowbook-disabled",!c);d(this.opts.controls.next).toggleClass("wowbook-disabled",!(f&&this.backPage(f.pageIndex)));
if((g=this.onShowPage)&&d.isFunction(g))g(this,this.pages[a],a),(h=this.otherPage(a))&&g(this,this.pages[h],h);this.opts.centeredWhenClosed&&this.origin.css("left",c&&f?0:c?e/2:-e/2);this.positionBookShadow();!1!==b&&this.opts.updateBrowserURL&&this.locationHashToPage()!=a&&(this.locationHashSetTo=window.location.hash=this.pageToLocationHash(a))},holdPage:function(a,b,c,f,e){"number"===typeof a&&(a=this.pages[a]);if(a){var d=a.data("pageIndex"),h=this.pages.length-1,i=this.pageIsOnTheLeft(h);if(f){if(!this.corners[f]||
(this.pageIsOnTheLeft(d)?/r/:/l/).test(f))return}else f=this.pageIsOnTheLeft(d)?"l":"r";void 0===e&&(e=this.backPage(d));if(e){var p=e.data("pageIndex");if(this.centeredWhenClosed&&(0===d||0===p||i&&(p===h||d===h))){var j=0,l,k=this.pageWidth,o,m,q,n,r,s,t,u;0===d&&(o=-k/2,m=-k/4,q=0,n=-k/2,r=-k,s=m,t=r,u=b);d===h&&i&&(o=k,m=3*k/2,q=k/2,n=0,r=k,s=2*k,t=b,u=s);0===p&&(o=k/2,m=d===h?k:3*k/2,q=d===h?k/2:0,n=-k/2,r=o,s=2*k,t=b,u=s);p===h&&i&&(o=0===d?0:-k/2,m=k/2,q=k/2,n=0===d?-k/2:0,r=-k,s=m,t=r,u=b);
b<o&&(j=q,l=t);b>m&&(j=n,l=u);b>=o&&b<=m&&(b=(b-o)/(m-o),j=q+b*(n-q),l=r+b*(s-r));b=l;this.origin.css("left",j);this.positionBookShadow()}this.zoomed||"basic"==this.pageType(a)||"basic"==this.pageType(e)?this.foldPageBasic(a,b,c,f,e):a.isHardPage||e.isHardPage?this.holdHardpage(a,b,c,f,e):this.foldPage(a,b,c,f,e);if(!a.data("holded")&&(a.addClass("wowbook-page-holded"),e.addClass("wowbook-page-holded"),a.data("holded",!0),this.holdedPage=a,this.holdedPageBack=e,this.shadows&&this.shadowClipper.css("display",
"block"),this.clipBoundaries&&this.clipper.css("overflow","visible"),this.positionBookShadow(),this.opts.onHoldPage))this.opts.onHoldPage(this,d,a,e)}}},foldPage:function(a,b,c,f,d){"number"===typeof a&&(a=this.pages[a]);var g=a.data("pageIndex");void 0===d&&(d=this.backPage(g));if(d&&d.length){var h=a.children().first(),g=d.children().first(),i=this.pageWidth,p=this.pageHeight,j=i/2,l=p/2;f||(f="tl");if("l"==f||"r"==f){var k=a.data("grabPoint");k||(k={x:"l"==f?0:i,y:c},a.data("grabPoint",k));var f=
(c>=k.y?"t":"b")+f,o=b-k.x,m=c-k.y,o=Math.atan2(m,o),k={x:0,y:(c>=k.y?0:p)-k.y},k=r(k,2*o),b=k.x+b,c=k.y+c}a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",f);d.css("left",a.css("left"));k=this.corners[f];f=i-k[0];fy=k[1];var o=b-f,m=c-fy,q=Math.sqrt(o*o+m*m);q>i&&(b=f+i*o/q,c=fy+i*m/q);fy=p-fy;o=b-f;m=c-fy;q=Math.sqrt(o*o+m*m);maxdistance=Math.sqrt(i*i+p*p);q>maxdistance&&(b=f+maxdistance*o/q,c=fy+maxdistance*m/q);f=k[0];k=k[1];if(f==b&&k==c)this.releasePage(a);else{k==c&&(c=k+0.001);o=b-f;m=c-
k;q=Math.sqrt(o*o+m*m);b=q/2;o=Math.atan2(m,o);m=Math.tan(o);c=o;o=180*o/Math.PI;h.css("transform","rotate("+-o+"deg)");var h={x:f-j,y:l-k},q=r(h,c),n=q.x+b+j;a.css({clip:"rect(-1000px 1000px 1000px "+n+"px)",transform:"rotate("+o+"deg)"});q=this.calculateOpacity(b,i,this.shadowThreshold,50);if(this.shadows&&0<q){var s=2*Math.sqrt(i*i+p*p),t=-(s-p)/2;this.internalShadow.css({display:"block",left:n+parseFloat(a.css("left")),height:s,top:t,transform:"rotate("+o+"deg)",transformOrigin:j-n+"px "+(l+(s-
p)/2)+"px"});n-=this.foldShadow.width();this.foldShadow.css({display:"block",left:n+parseFloat(a.css("left")),height:s,top:t,transform:"rotate("+o+"deg)",transformOrigin:j-n+"px "+(l+(s-p)/2)+"px"});this.shadowContainer.css({opacity:q,display:"block"})}else this.shadowContainer.hide();d.show();g.css("transform","rotate("+o+"deg)");h.x=-h.x;q=r(h,-c);n=q.x-b+j;d.css({clip:"rect(-1000px 1000px 1000px "+n+"px)",zIndex:1E3,transform:"rotate("+o+"deg)"});a={x:q.x-b,y:q.y+b*m};h={x:q.x-b,y:q.y-b/(0==m?
1.0E-4:m)};a=r(a,-c);h=r(h,-c);h=-(h.x+j);a=-(a.y-l);d.css({marginLeft:f+h,marginTop:k-a});q=this.calculateOpacity(2*b,2*i,this.foldGradientThreshold,50);this.foldGradient&&0<q?(d=2*Math.sqrt(i*i+p*p),this.foldGradientContainer.appendTo(g),this.foldGradientContainer.css({opacity:q,position:"absolute",left:i-f-this.foldGradientElem.width()/2,top:k-d/2,width:this.foldGradientElem.width(),height:d,transform:"rotate("+-o+"deg)"}),this.foldGradientElem.css({left:-b+this.foldGradientElem.width()/2,height:d}),
this.foldGradientContainer.show()):this.foldGradientContainer.hide()}}},holdHardpage:function(a,b,c,f,e){"number"===typeof a&&(a=this.pages[a]);var g=a.data("pageIndex"),h=this.pageIsOnTheRight(g),i=this.pageWidth,j=this.pageHeight;void 0===e&&(e=this.backPage(g));e&&e.length&&(f||(f="tl"),a.data("holdedAt",{x:b,y:c}),a.data("holdedCorner",f),f=h?i-b:b,c=h?0:i,0>f&&(f=0),f=(g=f<i)?a:e,(g?e:a).css("display","none"),a=h!=g,b-=c,b>i&&(b=i),b<-i&&(b=-i),h=-Math.sqrt(1600*(1-b*b/((i+15)*(i+15)))),e=Math.abs(b/
i),h=1==e?0:Math.atan2(h,b),f.css({transform:"skewY("+h+"rad) scaleX("+e+")",transformOrigin:(g?c:i-c)+"px 50%",display:"block",zIndex:1E3}),!d.support.transform&&d.support.filters&&(c="M11="+e+", M12=0, M21="+Math.tan(h)*e+", M22=1",f.css("filter","progid:DXImageTransform.Microsoft.Matrix("+c+", sizingMethod='auto expand')"),f.css({marginTop:j-f.height(),marginLeft:a?i-f.width():0})),this.shadows&&this.hardPageShadow.css({display:"block",left:a?0:i,opacity:0.5*Math.abs(b/i)}))},foldPageBasic:function(a,
b,c,d,e){"number"===typeof a&&(a=this.pages[a]);var g=a.data("pageIndex"),h=this.pageIsOnTheRight(g),i=!h;void 0===e&&(e=this.backPage(g));if(e&&e.length){var g=this.pageWidth,j=this.pageHeight,l=this.foldGradientElem.width(),n=this.foldShadow.width();d||(d="tl");a.data("foldPageBasic")||(a.data("foldPageBasic",!0),this.internalShadow.css("display","none"),this.foldShadow.css({display:"none",height:j,transform:"",top:0}).toggleClass("wowbook-shadow-fold-flipped",h),this.shadowContainer.css("display",
"block"),this.foldGradientContainer.appendTo(e.children().first()).css({width:l,height:j,top:0,transform:"",zIndex:1E9}),this.foldGradientElem.css({left:0,height:j}).toggleClass("wowbook-fold-gradient-flipped",h));a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",d);h=i?b:g-b;0>h&&(h=0);h>2*g&&(h=2*g);b=h/2;i?(c="rect(-1000px 1000px 1000px "+b+"px)",d="rect(-1000px 1000px 1000px "+(g-b)+"px)",h-=g):(c="rect(-1000px "+(g-b)+"px 1000px -1000px)",d="rect(-1000px "+b+"px 1000px -1000px)",h=g-h+g);a.css("clip",
c);e.css({clip:d,left:h,zIndex:1E3,display:"block"});a=this.calculateOpacity(2*b,2*g,this.shadowThreshold,50);this.shadows&&0<a?(e=i?b-n:g-b+g,this.shadowContainer.css("opacity",a),this.foldShadow.css({left:e,display:"block"})):this.foldShadow.css("display","none");a=this.calculateOpacity(2*b,2*g,this.foldGradientThreshold,50);this.foldGradient&&0<a?this.foldGradientContainer.css({opacity:a,left:i?g-b:b-l,display:"block"}):this.foldGradientContainer.css("display","none")}},animateFoldPage:function(a,
b,c,f,e,g,h){var i=this;if(!i.animating){i.animating=!0;c||(c=a.data("holdedAt"));b||(b=a.data("holdedCorner"));var j=c.x-f.x,l=c.y-f.y,f=this.turnPageDuration*Math.abs(j)/(2*this.pageWidth),n,k;!a.isHardPage&&0.4<f/this.turnPageDuration&&this.playFlipSound();this.holdPage(a,c.x,c.y,b,h);this._percent=0;d(this).animate({_percent:1},{duration:f,easing:"linear",complete:function(){i.animating=!1;d.isFunction(e)&&e()},step:function(d){n=c.x-d*j;k=c.y-d*l;g&&(k-=(0.5-Math.abs(0.5-d))*i.pageHeight/10);
i.holdPage(a,n,k,b,h)}})}},stopAnimation:function(){d(this).stop(!0,!0)},releasePages:function(){for(var a=0,b=this.pages.length;a<b;a++)this.pages[a].data("holded")&&this.releasePage(a)},releasePage:function(a,b,c){"number"===typeof a&&(a=this.pages[a]);var d=this,e=a.data("holdedAt"),g=a.data("holdedCorner");if(b&&e)this.animateFoldPage(a,g,e,{x:this.corners[g][0],y:this.corners[g][1]},function(){d.releasePage(a,!1,c)},!1,c);else if(b=a.data("pageIndex"),void 0===c&&(c=this.holdedPageBack||this.backPage(b)),
this.holdedPageBack=this.holdedPage=null,a.data({holdedAt:null,holdedCorner:null,grabPoint:!1,foldPageBasic:null,holded:!1}),this.clipBoundaries&&!this.zoomed&&this.clipper.css("overflow","hidden"),this.shadowClipper.css("display","none"),this.internalShadow.parent().hide(),this.foldGradientContainer.hide(),this.hardPageShadow.hide(),this.resetPage(a),c&&c.length&&(this.resetPage(c),c.hide()),this.foldShadow.removeClass("wowbook-shadow-fold-flipped").css("transform",""),this.foldGradientElem.removeClass("wowbook-fold-gradient-flipped").css("transform",
""),this.foldGradientContainer.css("transform","").appendTo(this.pagesContainer),this.positionBookShadow(),this.opts.onReleasePage)this.opts.onReleasePage(this,b,a,c)},resetPage:function(a){a.removeClass("wowbook-page-holded");this.resetCSS||(this.resetCSS={transform:"",transformOrigin:"",clip:"auto",marginLeft:0,marginTop:0,filter:""});var b=this.pageWidth,c=this.pageHeight;a.css(this.resetCSS).css({zIndex:a.data("zIndex"),width:b,height:c,left:this.pageIsOnTheLeft(a.data("pageIndex"))?0:b});d.browser.msie&&
9>d.browser.version&&a.attr("style",a.attr("style").replace(/clip\: [^;]+;/i,""));a=d(".wowbook-page-content",a);a.css(this.resetCSS);j(a,b,c)},gotoPage:function(a,b){if(!this.animating&&("string"===typeof a&&"#"==a[0]&&(a=this.selectorToPage(a)),0>a&&(a=0),a>this.pages.length-1&&(a=this.pages.length-1),!this.isOnPage(a))){var c=a<this.currentPage,d=this,e=c?d.leftPage():d.rightPage();if(e){var g,h;c?(g=this.leftPage(a),h=this.rightPage(a)):(g=this.rightPage(a),h=this.leftPage(a));if(c)for(var i=
e.pageIndex-1;0<=i;i--)this.pages[i].css("display","none");else for(var i=e.pageIndex+1,j=this.pages.length;i<j;i++)this.pages[i].css("display","none");g&&g.css("display","block");var l=a;g=e.data("holdedAt");i=e.data("holdedAt");j=e.data("holdedCorner")||(c?"tl":"tr");c?(i=i||{x:0,y:0},c={x:2*d.pageWidth,y:"bl"!=j?0:this.pageHeight}):(i=i||{x:this.pageWidth,y:0},c={x:-d.pageWidth,y:"br"!=j?0:this.pageHeight});d.animateFoldPage(e,j,i,c,function(){d.releasePage(e,false,h);d.showPage(l,b)},!g,h);return a}}},
back:function(){return this.gotoPage(this.currentPage-2)},advance:function(){return this.gotoPage(this.currentPage+2)},leftPage:function(a){a=void 0!==a?a:this.currentPage;this.pageIsOnTheRight(a)&&a--;return this.pages[a]||null},rightPage:function(a){a=void 0!==a?a:this.currentPage;this.pageIsOnTheLeft(a)&&a++;return this.pages[a]||null},pageIsOnTheRight:function(a){return!(a%2)},pageIsOnTheLeft:function(a){return!!(a%2)},otherPage:function(a){a+=this.pageIsOnTheRight(a)?-1:1;if(0>a||a>this.pages.length-
1)a=null;return a},isOnPage:function(a){return"number"===typeof a&&(a===this.currentPage||a===this.otherPage(this.currentPage))},backPage:function(a){return this.pages[a+(this.pageIsOnTheRight(a)?1:-1)]},pageType:function(a){a="number"===typeof a?this.pages[a]:a;return a.isHardPage?"hard":a.find(".wowbook-page-content.wowbook-basic-page").length?"basic":"soft"},calculateOpacity:function(a,b,c,d){if(a<=c||a>=b-c)return 0;if(a>=d&&a<=b-d)return 1;a>d&&(a=b-a);return(a-c)/(d-c)},startSlideShow:function(){this.slideShowRunning=
!0;this.advanceAfterTimeout(this.slideShowDelay);d(this.opts.controls.slideShow).addClass("wowbook-disabled")},advanceAfterTimeout:function(a){var b=this;this.slideShowTimer=setTimeout(function(){b.animating||b.holdedPage?b.advanceAfterTimeout(100):(b.advance(),b.isOnPage(b.pages.length-1)?b.stopSlideShow():b.advanceAfterTimeout(b.slideShowDelay+b.turnPageDuration))},a)},stopSlideShow:function(){clearTimeout(this.slideShowTimer);this.slideShowTimer=void 0;this.slideShowRunning=!1;d(this.opts.controls.slideShow).removeClass("wowbook-disabled")},
toggleSlideShow:function(){this.slideShowRunning?this.stopSlideShow():this.startSlideShow()},findSections:function(a){a&&(this.sectionDefinition=a);var b=this.sectionDefinition,a=[],c;"string"===typeof b&&(c=b,b=[],d(c,this.elem).each(function(a,c){b.push(["#"+c.id,d(c).html()])}));if(d.isArray(b)){for(var f=0,e=b.length;f<e;f++){c=b[f];if("string"===typeof c)try{c=[c,d(c,this.elem).html()]}catch(g){this.log("Something wrong happened at the function 'findSections' (maybe you have passed a invalid jquery selector?) :<br/>&nbsp;&nbsp;"+
g);continue}try{c[2]=this.selectorToPage(c[0])}catch(h){this.log("Something wrong happened at the function 'findSections' (maybe you have passed a invalid jquery selector?) :<br/>&nbsp;&nbsp;"+h);continue}void 0!==c[2]&&a.push({id:c[0],title:c[1],page:c[2]})}a=a.sort(function(a,b){return a.page-b.page})}return this.sections=a},pageToSection:function(a){for(var b=this.sections,c,d=0,e=b.length;d<e&&!(b[d].page>a);d++)c=b[d];return c},currentSection:function(){return this.pageToSection(this.currentPage)},
fillToc:function(a,b){var c=d(a||this.opts.toc),f,e,g="";if(0!==c.length){f=this.sections;"undefined"===typeof b&&(b=this.opts.tocTemplate);b||(g=c.is("UL, OL")?"<li>":"<div>",b='<a href="${link}">${section}</a>');for(var h=0,i=f.length;h<i;h++)e=f[h],e=b.replace(/\$\{link\}/g,"#"+this.id+"/"+e.id.substr(1)).replace(/\$\{section\}/g,e.title).replace(/\$\{page\}/g,e.page),d(e).appendTo(c).wrap(g)}},locationHashToPage:function(a){void 0===a&&(a=window.location.hash);if(a=="#"+this.id+"/")return 0;a=
a.slice(1).split("/");if(a[0]===this.id){if(1===a.length)return 0;var b=parseInt(a[1]);if(!isNaN(b))return Math.max(b-1,0);b=this.selectorToPage("#"+a[1]);if(void 0===b)return 0;isNaN(a[2])||(b+=Math.max(parseInt(a[2])-1,0));return+b}},pageToLocationHash:function(a){var b="",c=a+1;if(a=this.pageToSection(a))b+="/"+a.id.replace("#",""),c-=a.page;1<c&&(b+="/"+c);return"#"+this.id+(b||"/")},selectorToPage:function(a){a=d(a,this.elem).closest(".wowbook-page");if(a.length)return+a.data("pageIndex")},getLocationHash:function(){return window.location.hash.slice(1)},
locationEndsInHash:function(a){void 0===a&&(a=window.location.href);return a.lastIndexOf("#")==a.length-1},zoom:function(a){for(var b=0,c=this.pages.length;b<c;b++)if(this.pages[b].data("holdedAt"))return;1>a&&(a=1);a>this.zoomMax&&(a=this.zoomMax);if(a!==this.zoomLevel){this.zoomLevel=a;var f=this,b=this.zoomWindow,c=this.zoomContent,e=d(this.zoomBoundingBox),g=a,h=2*f.pageWidth*g,g=f.pageHeight*g,i=e.width(),j=e.height(),l=Math.min(h,i),n=Math.min(g,j),k=(this.opts.width-l)/2,o=(this.opts.height-
n)/2;b.css({width:l,height:n,left:k,top:o});this.zoomContentOverflowed=h>i||g>j;var m=b.offset(),e=e[0]!==window?e.offset():{left:e.scrollLeft(),top:e.scrollTop()};m.right=m.left+l;m.bottom=m.top+n;e.right=e.left+i;e.bottom=e.top+j;m.left<e.left&&b.css("left",k+(e.left-m.left));m.right>e.right&&b.css("left",k+(e.right-m.right));m.top<e.top&&b.css("top",o+(e.top-m.top));m.bottom>e.bottom&&b.css("top",o+(e.bottom-m.bottom));m=b.offset();e=c.offset();m.right=m.left+l;m.bottom=m.top+n;e.right=e.left+
h;e.bottom=e.top+g;e.left>m.left&&c.css("marginLeft",0);e.right<m.right&&c.css("marginLeft",(parseFloat(c.css("marginLeft"))||0)+(m.right-e.right));e.top>m.top&&c.css("marginTop",0);e.bottom<m.bottom&&c.css("marginTop",(parseFloat(c.css("marginTop"))||0)+(m.bottom-e.bottom));l===h&&c.css("marginLeft",0);n===g&&c.css("marginTop",0);d.support.transform?c.css({transform:"scale("+a+")",transformOrigin:"0 0"}):c.css("zoom",a);1===this.zoomLevel?(b.unbind("mousemove.wowbook").css({overflow:"visible",left:0,
top:0}),this.clipBoundaries&&this.clipper.css("overflow","hidden"),c.css({marginLeft:0,marginTop:0})):(this.clipBoundaries&&this.clipper.css("overflow","visible"),b.css("overflow","hidden"),this.zoomed||b.bind("mousemove.wowbook",function(a){f.zoomedAt(a)}));this.zoomed=1!==a;this.positionBookShadow();if(this.onZoom)this.onZoom(this)}},zoomIn:function(a){this.zoom(this.zoomLevel+(a||this.zoomStep))},zoomOut:function(a){this.zoom(this.zoomLevel-(a||this.zoomStep))},zoomedAt:function(a){if(this.zoomContentOverflowed){var b=
this.zoomLevel,c=this.zoomWindow.offset(),f=a.pageX-c.left,a=a.pageY-c.top,e=this.zoomWindow.width(),c=2*this.pageWidth*b-e,f=f/e,e=this.zoomWindow.height(),g=this.pageHeight*b-e;adjust=d.browser.ie8?b:1;this.zoomContent.css({marginLeft:-c*f/adjust,marginTop:-g*(a/e)/adjust})}},positionBookShadow:function(){var a=this.pages.length,b=!(!this.opts.bookShadow||this.zoomed||!a||3>a&&this.holdedPage);this.bookShadow.toggle(b);if(b){var b=this.pageWidth,c=this.currentPage,d=this.holdedPageBack&&this.holdedPageBack.pageIndex,
e=d&&this.pageIsOnTheLeft(d),c=0<c,g=this.rightPage(),c=!c||0===d,a=!g||d===a-1&&e,d=c!=a;c&&a?this.bookShadow.hide():this.bookShadow.css({left:(c?b:0)+this.pagesContainer.position().left,width:d?b:2*b})}},playFlipSound:function(){if(this.flipSound){var a=this.opts.onPlayFlipSound;d.isFunction(a)&&!1===a(this)||this.audio&&this.audio.play&&this.audio.play()}},createAudioPlayer:function(a,b){a||(a=this.opts.flipSoundPath);b||(b=this.opts.flipSoundFile);for(var c=[],f=0,e=b.length;f<e;f++)c.push('<source src="'+
a+b[f]+'">');return d("<audio preload>"+c.join("")+"</audio>")[0]},pageEdgeDragStart:function(a){if(this.animating||this.zoomed||!d(a.target).hasClass("wowbook-handle"))return!1;var b=this,c=b.elem.offset();b.mouseDownAtLeft=a.pageX-c.left<b.pageWidth;b.pageGrabbed=b.mouseDownAtLeft?b.leftPage():b.rightPage();if(!b.pageGrabbed)return!1;b.pageGrabbedOffset=b.pageGrabbed.offset();d(document).bind("mousemove.wowbook",function(a){return b.pageEdgeDrag(a)}).bind("mouseup.wowbook",function(a){return b.pageEdgeDragStop(a)});
return!1},pageEdgeDrag:function(a){this.holdPage(this.pageGrabbed,a.pageX-this.pageGrabbedOffset.left,a.pageY-this.pageGrabbedOffset.top);return!1},pageEdgeDragStop:function(a){var b=this.elem.offset(),a=a.pageX-b.left<this.pageWidth;this.mouseDownAtLeft&&!a?this.back():!this.mouseDownAtLeft&&a?this.advance():this.releasePage(this.pageGrabbed,!0);d(document).unbind(".wowbook")},controllify:function(a){var b=this;d(a.zoomIn).click(function(){b.zoomIn();return!1});d(a.zoomOut).click(function(){b.zoomOut();
return!1});d(a.next).click(function(){b.advance();return!1});d(a.back).click(function(){b.back();return!1});d(a.first).click(function(){b.gotoPage(0);return!1});d(a.last).click(function(){b.gotoPage(b.pages.length-1);return!1});d(a.slideShow).click(function(){b.toggleSlideShow();return!1})},log:function(a){if(this.opts.debug){var b=d("#wowbook_log");b.length||(b=d("<div/>",{id:"wowbook_log",style:"position: absolute; top:0; left:0; background: #F8F800; color:black; padding:1em;"}).appendTo("body"));
d("<div>",{html:a}).appendTo(b)}}};d.wowBook.defaults={width:500,height:300,startPage:0,hardcovers:!1,hardPages:!1,centeredWhenClosed:!1,transparentPages:!1,bookShadow:!0,gutterShadow:!0,shadowThreshold:20,shadows:!0,foldGradient:!0,foldGradientThreshold:20,pageNumbers:!0,firstPageNumber:1,numberedPages:!1,deepLinking:!0,updateBrowserURL:!0,slideShow:!1,slideShowDelay:1E3,pauseOnHover:!0,mouseWheel:!1,handleWidth:!1,handleClickDuration:100,turnPageDuration:1E3,forceBasicPage:!1,sections:".wowbook-section",
zoomLevel:1,zoomMax:2,zoomBoundingBox:window,zoomStep:0.05,onZoom:null,flipSound:!0,flipSoundFile:["page-flip.mp3","page-flip.ogg"],flipSoundPath:"./js/",onPlayFlipSound:null,keyboardNavigation:{back:37,advance:39},clipBoundaries:!0,controls:{},onShowPage:!1,onHoldPage:null,onReleasePage:null};d.browser.ie8=d.browser.msie&&8==d.browser.version;var l=d.browser.msie&&9>d.browser.version?1:0,n={thin:2-l,medium:4-l,thick:6-l}})(jQuery);
(function(d){function t(j){var l=j||window.event,n=[].slice.call(arguments,1),a=0,b=0,c=0,j=d.event.fix(l);j.type="mousewheel";l.wheelDelta&&(a=l.wheelDelta/120);l.detail&&(a=-l.detail/3);c=a;void 0!==l.axis&&l.axis===l.HORIZONTAL_AXIS&&(c=0,b=-1*a);void 0!==l.wheelDeltaY&&(c=l.wheelDeltaY/120);void 0!==l.wheelDeltaX&&(b=-1*l.wheelDeltaX/120);n.unshift(j,a,b,c);return(d.event.dispatch||d.event.handle).apply(this,n)}var r=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var s=r.length;s;)d.event.fixHooks[r[--s]]=
d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var d=r.length;d;)this.addEventListener(r[--d],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var d=r.length;d;)this.removeEventListener(r[--d],t,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}})})(jQuery);
(function(d){function t(j){if(j in r.style)return d.support[j]=j;for(var l=s.length,n,a=j.charAt(0).toUpperCase()+j.substr(1);l--;)if(n=s[l]+a,n in r.style)return d.support[j]=n}if(d.cssHooks){var r=document.createElement("div"),s=["O","ms","Webkit","Moz"];t("transform");t("transformOrigin");t("boxSizing");d.support.boxSizing&&d.browser.msie&&7==d.browser.version&&(d.support.boxSizing=!1);r=null;d.support.transform&&"transform"!==d.support.transform&&!d.cssHooks.transform&&(d.cssHooks.transform={get:function(j){return d.css(j,
d.support.transform)},set:function(j,l){j.style[d.support.transform]=l}});d.support.transformOrigin&&"transformOrigin"!==d.support.transformOrigin&&!d.cssHooks.transformOrigin&&(d.cssHooks.transformOrigin={get:function(j){return d.css(j,d.support.transformOrigin)},set:function(j,l){j.style[d.support.transformOrigin]=l}});d.wowBook.applyAlphaImageLoader=function(j){var l,n,a,b,c="",f=d("<div style='display:none'></div>").appendTo("body");n=0;for(a=j.length;n<a;n++){b=j[n];f.addClass(b);if(l=f.css("background-image").match(/^url\("(.*)"\)$/)){c=
c+("."+b+"{background:none; filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+l[1]+"', sizingMethod='scale'); } ");f.removeClass(b)}}d("body").append("<style>"+c+"</style>")}}else alert("jQuery 1.4.3+ is needed for this plugin to work")})(jQuery);
